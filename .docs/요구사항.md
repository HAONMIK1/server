
---

# 📌 요구사항 정리 (기능적 / 비기능적 / 기술적 고려사항)

# API별 기능/비기능 요구사항 분석

## 1. 잔액 충전/조회 API

### 기능 요구사항

### 잔액 충전/조회 API

- 충전 금액 양수 검증
- 최소/최대 충전 금액 범위 검증
- 잔액 한도 초과 검증
- 충전 이력 저장
- 사용자 현재 잔액 조회

### 비기능 요구사항

- 동일 사용자 동시 충전 요청 처리 보장

---

## 2. 상품 조회 API

### 기능 요구사항

- 상품 조회
- 실시간 재고 수량 반영
- 상품 상태 (판매중/품절)
- 실시간 재고 확인
- 판매 통계 정보 포함
- 상품조회시에 조회수가 업데이트 비동기처리

### 비기능 요구사항

- 응답시간 2초 이내
- 조회수 업데이트는 비동기로 분리하여 성능영향 최소화
- 재고 수량 및 상태는 실시간 기준

---

## 3. 선착순 쿠폰 발급 API

### 기능 요구사항

- 쿠폰 발급 가능 여부 확인 (1인 1회)
- 쿠폰 재고 차감 (SELECT FOR UPDATE)
- 발급 완료 처리
- 사용 상태 (미사용/사용완료/만료)

### 비기능 요구사항

- 동시 접속 상황에서 정확한 재고 관리
- 선착순 처리
- 동일 사용자 중복 발급 차단
- 트랜잭션 처리 및 롤백 처리

---

## 4. 주문/결제 API

### 기능 요구사항

- 상품 재고 확인
- 쿠폰 유효성 및 사용 가능 여부 확인
- 총 결제 금액 계산
- 사용자 잔액 확인
- 주문 정보 저장 (대기 상태)
- 재고 최종 확인 및 차감
- 사용자 잔액 차감
- 사용자 잔액 사용 이력 저장
- 쿠폰 사용 처리
- 주문 상태 업데이트 (완료)
- 결제 내역 저장
- 데이터 플랫폼 전송

### 비기능 요구사항

- 트랜잭션 처리 및 롤백 처리
- 정확한 재고 관리

---

## 5. 인기 상품 조회 API

### 기능 요구사항

- 최근 3일간 판매량 기준 정렬
- 상위 5개 상품 선별
- 판매 통계 정보 포함
- 배치 처리 기능
    - 상품판매량 테이블의 판매량 15마다  집계
    - 최근 3일간 판매량 상위 5개 상품 집계
    - 판매량 동일시 조회수,최신등록일순으로 집계
    - 인기 상품 테이블 업데이트

### 비기능 요구사항

- 응답시간 2초 이내
- 판매량 집계 정확성 보장
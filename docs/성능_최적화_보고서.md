# ğŸš€ ì¸ê¸° ìƒí’ˆ ì¡°íšŒ ì¿¼ë¦¬ ì„±ëŠ¥ ìµœì í™” ë³´ê³ ì„œ

## ğŸ“‹ í…ŒìŠ¤íŠ¸ í™˜ê²½

| í•­ëª©         | ë‚´ìš©                             |
|--------------|----------------------------------|
| DBMS         | MySQL 9.3.0                      |
| ë°ì´í„°ëŸ‰     | ê° í…Œì´ë¸”ë³„ 5,000,000ê±´          |
| í…ŒìŠ¤íŠ¸ ëŒ€ìƒ  | ì¸ê¸° ìƒí’ˆ TOP 5 ì¡°íšŒ ì¿¼ë¦¬        |
| ì£¼ìš” í…Œì´ë¸”  | `product`, `product_sales_count`, `product_view_count` |

---

## ğŸ“Š ë°ì´í„° í˜„í™©

```sql
SELECT 
  (SELECT COUNT(*) FROM product) AS product_count,
  (SELECT COUNT(*) FROM product_sales_count) AS sales_count,
  (SELECT COUNT(*) FROM product_view_count) AS view_count;
```

| product_count | sales_count | view_count |
|---------------|-------------|------------|
| 5,000,000     | 5,000,000   | 5,000,000  |

---

## ğŸ” ë³‘ëª© ì¿¼ë¦¬ ë° ì„±ëŠ¥ ë¶„ì„

### A. ê¸°ì¡´ ì¿¼ë¦¬ (LEFT JOIN + ì •ë ¬)

```sql
SELECT p.id, ps.sales_count, pv.view_count, p.reg_dt
FROM product p 
LEFT JOIN product_sales_count ps ON p.id = ps.product_id 
LEFT JOIN product_view_count pv ON p.id = pv.product_id 
ORDER BY ps.sales_count DESC, pv.view_count DESC, p.reg_dt DESC 
LIMIT 5;
```

- â± **ì‹¤í–‰ ì‹œê°„**: 16.394ì´ˆ
- âŒ ì •ë ¬ ëŒ€ìƒì´ ì „ì²´ í…Œì´ë¸”ë¡œ ì •ë ¬ ë¹„ìš© ê³¼ë‹¤
- âŒ OUTER JOINìœ¼ë¡œ ì¸í•œ ëŠìŠ¨í•œ ì¡°ì¸

---

### B. INNER JOINìœ¼ë¡œ ë‹¨ìˆœ ë³€ê²½

```sql
SELECT p.id, ps.sales_count, pv.view_count, p.reg_dt
FROM product p 
INNER JOIN product_sales_count ps ON p.id = ps.product_id 
INNER JOIN product_view_count pv ON p.id = pv.product_id 
ORDER BY ps.sales_count DESC, pv.view_count DESC, p.reg_dt DESC 
LIMIT 5;
```

- â± **ì‹¤í–‰ ì‹œê°„**: 13.183ì´ˆ
- âœ… OUTER JOIN ì œê±°ë¡œ ë¶ˆí•„ìš”í•œ row ì œì™¸
- âŒ ì—¬ì „íˆ 5,000,000ê±´ ì •ë ¬ë¡œ ë³‘ëª© ìœ ì§€

---

### C. ë³µí•© ì¸ë±ìŠ¤ë§Œ ì ìš©í•œ ê¸°ì¡´ ì¿¼ë¦¬

```sql
CREATE INDEX idx_product_sales_optimized 
  ON product_sales_count (product_id, sales_count DESC);

CREATE INDEX idx_product_view_optimized 
  ON product_view_count (product_id, view_count DESC);
```

- ê¸°ì¡´ ì¿¼ë¦¬ ë™ì¼í•˜ê²Œ ì‚¬ìš©
- â± **ì‹¤í–‰ ì‹œê°„**: 13.034ì´ˆ
- âŒ ì¸ë±ìŠ¤ë§Œ ì¶”ê°€í•´ë„ ì„±ëŠ¥ ê°œì„  íš¨ê³¼ëŠ” ë¯¸ë¯¸
- ğŸ” ì •ë ¬ ë²”ìœ„ê°€ ì¤„ì–´ë“¤ì§€ ì•Šê¸° ë•Œë¬¸

---

## âœ… ìµœì í™” ì¿¼ë¦¬

```sql
SELECT p.id, ps.sales_count, pv.view_count, p.reg_dt
FROM (
    SELECT product_id, sales_count
    FROM product_sales_count
    ORDER BY sales_count DESC
    LIMIT 50
) ps
JOIN product p ON p.id = ps.product_id
JOIN product_view_count pv ON p.id = pv.product_id
ORDER BY ps.sales_count DESC, pv.view_count DESC, p.reg_dt DESC
LIMIT 5;
```

### ê²°ê³¼

- â± ì¸ë±ìŠ¤ ì „: 0.817ì´ˆ
- âœ… ì¸ë±ìŠ¤ í›„: 0.008ì´ˆ

### í•µì‹¬ ìµœì í™” ì „ëµ

| ì „ëµ                 | ì„¤ëª…                                  |
|----------------------|---------------------------------------|
| ì„œë¸Œì¿¼ë¦¬ë¡œ ì •ë ¬ ë²”ìœ„ ì¶•ì†Œ | 5,000,000ê±´ â†’ 50ê±´ìœ¼ë¡œ ì¶•ì†Œ             |
| ì •ë ¬ ìˆœì„œ ë‹¨ìˆœí™”     | sales_count DESC â†’ LIMIT ì´í›„ JOIN |
| ì¸ë±ìŠ¤ ë³‘ë ¬ í™œìš©     | product_id, sales_count, view_countì— ì¸ë±ìŠ¤ ì‚¬ìš© |

---

## ğŸ”§ ì¸ë±ìŠ¤ êµ¬ì¡°

```sql
-- sales ì •ë ¬ì„ ìœ„í•œ ë³µí•© ì¸ë±ìŠ¤
CREATE INDEX idx_product_sales_optimized 
  ON product_sales_count (product_id, sales_count DESC);

-- view ì •ë ¬ì„ ìœ„í•œ ë³µí•© ì¸ë±ìŠ¤
CREATE INDEX idx_product_view_optimized 
  ON product_view_count (product_id, view_count DESC);

-- ë“±ë¡ì¼ ì •ë ¬ ì¸ë±ìŠ¤
CREATE INDEX idx_product_reg_dt 
  ON product (reg_dt DESC);
```

---

## ğŸ“ˆ ì„±ëŠ¥ ë¹„êµ ìš”ì•½

| ë²„ì „                     | ì‹¤í–‰ ì‹œê°„ | ì •ë ¬ ëŒ€ìƒ   | ì£¼ìš” íŠ¹ì§•                    |
|--------------------------|------------|-------------|------------------------------|
| A. LEFT JOIN             | 16.394ì´ˆ   | 5,000,000ê±´ | OUTER JOIN + FULL ì •ë ¬       |
| B. INNER JOIN            | 13.183ì´ˆ   | 5,000,000ê±´ | JOIN ì¡°ê±´ ê°œì„  ë¶ˆì¶©ë¶„        |
| C. ë³µí•© ì¸ë±ìŠ¤ë§Œ ì ìš©    | 13.034ì´ˆ   | 5,000,000ê±´ | ì¸ë±ìŠ¤ë§Œìœ¼ë¡  ì˜ë¯¸ ì—†ìŒ       |
| âœ… D. ìµœì í™” ì¿¼ë¦¬ ì ìš©   | 0.008ì´ˆ    | 50ê±´        | ì •ë ¬ ë²”ìœ„ ì œí•œ + ì¸ë±ìŠ¤ í™œìš© |

---
